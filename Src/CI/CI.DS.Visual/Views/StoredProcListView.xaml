<UserControl x:Class="CI.DS.Visual.Views.StoredProcListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:CI.DS.Visual.Views"
             xmlns:stb="clr-namespace:CI.Visual.Lib.Helpers;assembly=CI.Visual.Lib" 
             mc:Ignorable="d" 
             d:DesignHeight="350" d:DesignWidth="800" Background="{DynamicResource MenuItemBackground0}" Loaded="onLoaded">
  <UserControl.Resources>

    <Style TargetType="{x:Type stb:HighlightableTextBlock}">
      <Setter Property="ToolTipService.ShowDuration" Value="999999" />
      <Setter Property="HighlightForeground" Value="#c00" />
      <Setter Property="HighlightBackground" Value="#fcc" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type stb:HighlightableTextBlock}">
            <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
              <TextBlock x:Name="PART_TEXT"/>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <DataTemplate x:Key="myTaskTemplate">
      <stb:HighlightableTextBlock Text="{Binding SPName}" SearchText="{Binding Text, ElementName=tbxSearch}" ToolTip="{Binding SPName}" Margin="5 0" />
    </DataTemplate>
    
  </UserControl.Resources>
  <Grid Margin="30,10,30,10" >
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <StackPanel Grid.Row="0" >
      <TextBlock Text="Stored Procedures Raw" FontSize="26" Margin="0 20" />

      <Label Content="Search" />
      <TextBox Text="{Binding SearchString, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Stretch" x:Name="tbxSearch" />

      <Label Content="DB Processes"    />
    </StackPanel>

    <ListBox    Grid.Row="1" 
                ItemsSource="{Binding SpdCollectionView}" 
                ItemTemplate="{StaticResource myTaskTemplate}" 
                SelectedValue="{Binding SPName}" 
                SelectedValuePath="SPName" />

    <StackPanel Grid.Row="2" >
      <Label Content="Selected DB Process:" />
      <TextBlock Text="{Binding SPName}"  d:Text="Sample Stored Proc Name" FontSize="18" />

      <Button Content="_Check" IsDefault="True" HorizontalAlignment="Center" />
    </StackPanel>

  </Grid>
</UserControl>
